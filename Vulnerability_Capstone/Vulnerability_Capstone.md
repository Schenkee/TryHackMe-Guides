# üß† TryHackMe Room: Vulnerability Capstone  

**Room URL:** [https://tryhackme.com/room/vulnerabilitycapstone](https://tryhackme.com/room/vulnerabilitycapstone)  
**Author:** Schenkee  
**Profile:** [https://tryhackme.com/p/schenkee](https://tryhackme.com/p/schenkee)  

---

## üß© Challenge Task Overview

**Objective:**   
This guide will cover the steps required to gain the answer to all question in the Vulnerability Capstone room which concludes the Vulnerability Research module. There are many different exploits out there that can be used to exploit this vulnerability. But I found the one included below useful as it included a webshell and also a reverse shell. You can of course use only a webshell and then use this to load in a reverse shell.  

---

## üß∞ Tools I Used  
- [Exploit-DB](https://www.exploit-db.com/)
- Searchsploit  
- FuelCMS webshell + netcat reverse shell by ac1d/AssassinUKG found here: [https://github.com/AssassinUKG/fuleCMS](https://github.com/AssassinUKG/fuleCMS)
- NetCat  

---

Firstly lets start our target machine and give it a few minutes to start all relevant services. It is recommanded to use the TryHackME AttackBox for this room, but I had no problems completing the room from my own VM via the VPN.  

---

## üõ†Ô∏è TASK 1: Name of the application and version number running on the machine?   
Once the machine has loaded we can navigate to the machine IP in our browser to locate the application name and version number without much difficulty.  

As we can see below the details for the application name and version are not hard to miss once we have loaded the website in our browser.  
![Question 1 and 2](./Images/Question%201%20and%202.png)  

---

## üõ†Ô∏è TASK 3: CVE number that allows remote code exucution on this application?  
With the information we have gathered from question one and two in regards to the application name and version we can hope over to [Exploit-DB](https://www.exploit-db.com/) and search for FuelCMS. This will return us the below seven results, with six of them being related to version 1.4 and three beinf remote code execution explots.  
![Question 3](./Images/Question%203.png)  

Lets click on one of the rce's related to version 1.4.1 and this will show us the related CVE.   
![Question 3 CVE](./Images/Question%203%20CVE.png)  

---

## üõ†Ô∏è TASK 4: Value of the flag located on the machine? 
Now we have all the related information to start to exploit the vulnerable machine. Using Searchsploit we can see if there are any of these exploits present on our own machines or the attackbox.  
We can do this via ```searchsploit fuel CMS | grep Remote``` We pipe our search into grep to only return expoits listed as Remote Code Exection.  
![Question 5 Others](./Images/Question%205%20others.png)  

In the end I did not use either of these three and found a different option on Github that included with the inital webshell and the reverse shell. But you are welcome to try with the above three listed webshells and then load your own reverse shell payload onto the vulnerable machine seperatly.  

The exploit I used can be found here: [https://github.com/AssassinUKG/fuleCMS](https://github.com/AssassinUKG/fuleCMS)  
Once you have saved the above onto your machine in a ```.py``` file lets run the initial exploit via ```python3 FILE_NAME.py TARGET_IP``` if succesfull you will be greated with the below.  
![Question 5 initial](./Images/Question%205%20initial.png)  

Now our next step is to get a revserse shell. But first we will need to create a Netcat listner to grab the reverse connection to our machine. 
This can be done via ```nc -lnvp PORT```  as below.  
![Question 5 lisnter](./Images/Question%205%20listner.png)  

Once our listner is up and running lets type in ```shell_me``` to the terminal window with the Fuel CMS webshell.  This will then promt us to enter the ```IP:PORT``` of our machine to match the listner. Pop these details in and hit enter and if succesfully you will see a message saying ```Hope you had your listner ready !!```  
![Question 5 shell](./Images/Question%205%20shell.png)  

If the listner was correctly setup we should have recived a reverse connection as below.  
![Question 5 connection](./Images/Question%205%20connection.png)  

Now we can navigate our way to the ```/home/ubuntu``` folder which contains the flag. Once there we can simply use ```cat flag.txt``` to reveale the flag value and complete this room.  
![Question 5 flag](./Images/Question%205%20flag.png)  

---

## üß† Takeaways


---

Thank you for following through my guide of the TryHackMe Net Sec Challenge.

