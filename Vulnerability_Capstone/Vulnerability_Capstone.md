# üß† TryHackMe Room: Vulnerability Capstone  

**Room URL:** [https://tryhackme.com/room/vulnerabilitycapstone](https://tryhackme.com/room/vulnerabilitycapstone)  
**Author:** Schenkee  
**Profile:** [https://tryhackme.com/p/schenkee](https://tryhackme.com/p/schenkee)  

---

## üß© Challenge Task Overview

**Objective:**   
This guide will cover the steps required to gain the answer to all question in the Vulnerability Capstone room which concludes the Vulnerability Research module. There are many different exploits out there that can be used to exploit this vulnerability. But I found the one included below useful as it included a webshell and a reverse shell. You can of course use only a webshell and then use this to load in a reverse shell.  

---

## üß∞ Tools I Used  
- [Exploit-DB](https://www.exploit-db.com/)
- Searchsploit  
- FuelCMS webshell + netcat reverse shell by ac1d/AssassinUKG found here: [https://github.com/AssassinUKG/fuleCMS](https://github.com/AssassinUKG/fuleCMS)
- NetCat  

---

Firstly, let‚Äôs start our target machine and give it a few minutes to start all relevant services. It is recommended to use the TryHackME AttackBox for this room, but I had no problems completing the room from my own VM via the VPN.  

---

## üõ†Ô∏è TASK 1: Name of the application and version number running on the machine?   
Once the machine has loaded, we can navigate to the machine IP in our browser to locate the application name and version number without much difficulty.  

As we can see below the details for the application name and version are not hard to miss once we have loaded the website in our browser.  
![Question 1 and 2](./Images/Question%201%20and%202.png)  

---

## üõ†Ô∏è TASK 3: CVE number that allows remote code execution on this application?  
With the information we have gathered from question one and two in regard to the application name and version we can hope over to [Exploit-DB](https://www.exploit-db.com/) and search for Fuel CMS. This will return us the below seven results, with six of them being related to version 1.4 and three being remote code execution exploits.  
![Question 3](./Images/Question%203.png)  

Lets click on one of the rce's related to version 1.4.1 and this will show us the related CVE.   
![Question 3 CVE](./Images/Question%203%20CVE.png)  

---

## üõ†Ô∏è TASK 4: Value of the flag located on the machine? 
Now we have all the related information to start to exploit the vulnerable machine. Using Searchsploit we can see if there are any of these exploits present on our own machines or the attackbox.  
We can do this via 
```bash
searchsploit fuel CMS | grep Remote
``` 
We pipe our search into grep to only return exploits listed as Remote Code Execution.  
![Question 5 Others](./Images/Question%205%20others.png)  

In the end I did not use either of these three and found a different option on GitHub that included with the initial webshell and the reverse shell. But you are welcome to try with the above three listed webshells and then load your own reverse shell payload onto the vulnerable machine separately.  

The exploit I used can be found here: [https://github.com/AssassinUKG/fuleCMS](https://github.com/AssassinUKG/fuleCMS)  
Once you have saved the above onto your machine in a ```.py``` file lets run the initial exploit via 
```bash
python3 FILE_NAME.py TARGET_IP
``` 
if successful you will be greeted with the below.  
![Question 5 initial](./Images/Question%205%20initial.png)  

Now our next step is to get a reverse shell. But first we will need to create a Netcat listener to grab the reverse connection to our machine. 
This can be done via 
```bash
nc -lnvp PORT
```  
as below.  
![Question 5 lisnter](./Images/Question%205%20listner.png)  

Once our listener is up and running let‚Äôs type in ```shell_me``` to the terminal window with the Fuel CMS webshell.  This will then prompt us to enter the ```IP:PORT``` of our machine to match the listener. Pop these details in and hit enter and if successfully you will see a message saying ```Hope you had your listener ready !!```  
![Question 5 shell](./Images/Question%205%20shell.png)  

If the listener was correctly setup we should have received a reverse connection as below.  
![Question 5 connection](./Images/Question%205%20connection.png)  

Now we can navigate our way to the ```/home/ubuntu``` folder which contains the flag. Once there we can simply use 
```bash
cat flag.txt
```
to reveal the flag value and complete this room.  
![Question 5 flag](./Images/Question%205%20flag.png)  

---

## üß† Takeaways  
- Practiced identifying application name and version directly from the web interface without needing deep enumeration.  
- Demonstrated ability to map discovered software versions to relevant CVEs using Exploit-DB and Searchsploit.  
- Learned to evaluate multiple public exploits and select one that streamlined the process by combining a webshell with a reverse shell.  
- Reinforced the importance of setting up a netcat listener before triggering a reverse shell to avoid missing connections.  
- Strengthened the methodical approach: enumerate ‚Üí research vulnerabilities ‚Üí select exploit ‚Üí execute ‚Üí stabilize shell ‚Üí capture flag.  

---

Thank you for following through my guide of the TryHackMe Vulnerability Capstone.  
